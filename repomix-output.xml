This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
backend/chat.db
backend/go.mod
backend/main.go
frontend/.gitignore
frontend/.npmrc
frontend/.prettierignore
frontend/.prettierrc
frontend/.vscode/settings.json
frontend/package.json
frontend/README.md
frontend/src/app.d.ts
frontend/src/app.html
frontend/src/lib/assets/favicon.svg
frontend/src/lib/index.ts
frontend/src/routes/+layout.svelte
frontend/src/routes/+page.svelte
frontend/src/routes/layout.css
frontend/static/robots.txt
frontend/svelte.config.js
frontend/tsconfig.json
frontend/vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="backend/go.mod">
module lobe-backend

go 1.25.5

require (
	github.com/dustin/go-humanize v1.0.1 // indirect
	github.com/google/uuid v1.6.0 // indirect
	github.com/labstack/echo/v4 v4.15.0 // indirect
	github.com/labstack/gommon v0.4.2 // indirect
	github.com/mattn/go-colorable v0.1.14 // indirect
	github.com/mattn/go-isatty v0.0.20 // indirect
	github.com/ncruces/go-strftime v0.1.9 // indirect
	github.com/remyoudompheng/bigfft v0.0.0-20230129092748-24d4a6f8daec // indirect
	github.com/valyala/bytebufferpool v1.0.0 // indirect
	github.com/valyala/fasttemplate v1.2.2 // indirect
	golang.org/x/crypto v0.46.0 // indirect
	golang.org/x/exp v0.0.0-20250620022241-b7579e27df2b // indirect
	golang.org/x/net v0.48.0 // indirect
	golang.org/x/sys v0.39.0 // indirect
	golang.org/x/text v0.32.0 // indirect
	golang.org/x/time v0.14.0 // indirect
	modernc.org/libc v1.66.10 // indirect
	modernc.org/mathutil v1.7.1 // indirect
	modernc.org/memory v1.11.0 // indirect
	modernc.org/sqlite v1.42.2 // indirect
)
</file>

<file path="backend/main.go">
package main

import (
	"bufio"
	"bytes"
	"database/sql" // Go 标准库的数据库接口
	"encoding/json"
	"fmt"
	"log"
	"net/http"
	"strings"

	"github.com/labstack/echo/v4"
	"github.com/labstack/echo/v4/middleware"
	_ "modernc.org/sqlite" // 刚才安装的 SQLite 驱动
)

// --- 1. 配置与全局变量 ---
const (
	API_KEY = "sk-b828e1362f614206bde9ddf87b2476a2"
	API_URL = "https://api.deepseek.com/chat/completions"
	DB_FILE = "./chat.db" // 数据库文件名
)

var db *sql.DB // 全局数据库连接对象

// 消息结构体
type Message struct {
	Role    string `json:"role"`
	Content string `json:"content"`
}

type ChatRequest struct {
	Message string `json:"message"`
}

type StreamResponse struct {
	Choices []struct {
		Delta struct {
			Content string `json:"content"`
		} `json:"delta"`
	} `json:"choices"`
}

// --- 2. 数据库初始化函数 ---
func initDB() {
	var err error
	// 打开（或创建）数据库文件
	db, err = sql.Open("sqlite", DB_FILE)
	if err != nil {
		log.Fatal("无法打开数据库:", err)
	}

	// 创建表结构：id, 角色(user/assistant), 内容
	// IF NOT EXISTS 保证了如果表已经存在，就不会重复创建
	sqlStmt := `
	CREATE TABLE IF NOT EXISTS messages (
		id INTEGER PRIMARY KEY AUTOINCREMENT,
		role TEXT NOT NULL,
		content TEXT NOT NULL,
		created_at DATETIME DEFAULT CURRENT_TIMESTAMP
	);`
	_, err = db.Exec(sqlStmt)
	if err != nil {
		log.Fatal("创建表失败:", err)
	}
	fmt.Println("数据库初始化成功，文件位置:", DB_FILE)
}

// 保存消息到数据库
func saveMessage(role, content string) {
	_, err := db.Exec("INSERT INTO messages (role, content) VALUES (?, ?)", role, content)
	if err != nil {
		log.Println("保存消息失败:", err)
	}
}

func main() {
	// 程序启动第一步：初始化数据库
	initDB()
	defer db.Close()

	e := echo.New()
	e.Use(middleware.CORSWithConfig(middleware.CORSConfig{
		AllowOrigins: []string{"http://localhost:5173"},
	}))

	// --- 接口 A：获取历史记录 ---
	e.GET("/api/history", func(c echo.Context) error {
		rows, err := db.Query("SELECT role, content FROM messages ORDER BY id ASC")
		if err != nil {
			return c.JSON(http.StatusInternalServerError, map[string]string{"error": "读取历史失败"})
		}
		defer rows.Close()

		var history []Message
		for rows.Next() {
			var msg Message
			if err := rows.Scan(&msg.Role, &msg.Content); err == nil {
				history = append(history, msg)
			}
		}
		return c.JSON(http.StatusOK, history)
	})

	// --- 接口 B：聊天并保存 ---
	e.POST("/api/chat", func(c echo.Context) error {
		req := new(ChatRequest)
		if err := c.Bind(req); err != nil {
			return err
		}

		// 1. 先把用户的消息存进数据库
		saveMessage("user", req.Message)

		requestBody, _ := json.Marshal(map[string]interface{}{
			"model": "deepseek-chat",
			"messages": []map[string]string{
				{"role": "system", "content": "你是一个有用的助手。"},
				{"role": "user", "content": req.Message},
			},
			"stream": true,
		})

		client := &http.Client{}
		httpReq, _ := http.NewRequest("POST", API_URL, bytes.NewBuffer(requestBody))
		httpReq.Header.Set("Content-Type", "application/json")
		httpReq.Header.Set("Authorization", "Bearer "+API_KEY)

		resp, err := client.Do(httpReq)
		if err != nil {
			return c.String(http.StatusInternalServerError, "AI 连接失败")
		}
		defer resp.Body.Close()

		c.Response().Header().Set(echo.HeaderContentType, "text/event-stream")
		c.Response().WriteHeader(http.StatusOK)

		// 用于累积 AI 的完整回复，最后存入数据库
		var fullAIResponse strings.Builder

		scanner := bufio.NewScanner(resp.Body)
		for scanner.Scan() {
			line := scanner.Text()
			if strings.HasPrefix(line, "data: ") {
				data := strings.TrimPrefix(line, "data: ")
				if data == "[DONE]" {
					break
				}

				var streamResp StreamResponse
				if err := json.Unmarshal([]byte(data), &streamResp); err == nil {
					if len(streamResp.Choices) > 0 {
						content := streamResp.Choices[0].Delta.Content
						if content != "" {
							// 累积内容
							fullAIResponse.WriteString(content)
							// 发送给前端
							fmt.Fprintf(c.Response().Writer, "data: %s\n\n", content)
							c.Response().Flush()
						}
					}
				}
			}
		}

		// 2. AI 说完了，把完整回复存进数据库
		if fullAIResponse.Len() > 0 {
			saveMessage("assistant", fullAIResponse.String())
		}

		return nil
	})

	fmt.Println("真 AI + 数据库后端已启动：http://localhost:8080")
	e.Logger.Fatal(e.Start(":8080"))
}
</file>

<file path=".gitignore">
# 忽略前端依赖
frontend/node_modules/
frontend/.svelte-kit/
frontend/build/

# 忽略后端编译文件
backend/backend.exe

# 忽略系统文件
.DS_Store
Thumbs.db
</file>

<file path="frontend/.gitignore">
node_modules

# Output
.output
.vercel
.netlify
.wrangler
/.svelte-kit
/build

# OS
.DS_Store
Thumbs.db

# Env
.env
.env.*
!.env.example
!.env.test

# Vite
vite.config.js.timestamp-*
vite.config.ts.timestamp-*
</file>

<file path="frontend/.npmrc">
engine-strict=true
</file>

<file path="frontend/.prettierignore">
# Package Managers
package-lock.json
pnpm-lock.yaml
yarn.lock
bun.lock
bun.lockb

# Miscellaneous
/static/
</file>

<file path="frontend/.prettierrc">
{
	"useTabs": true,
	"singleQuote": true,
	"trailingComma": "none",
	"printWidth": 100,
	"plugins": [
		"prettier-plugin-svelte",
		"prettier-plugin-tailwindcss"
	],
	"tailwindStylesheet": "./src/routes/layout.css",
	"overrides": [
		{
			"files": "*.svelte",
			"options": {
				"parser": "svelte"
			}
		}
	]
}
</file>

<file path="frontend/.vscode/settings.json">
{
	"files.associations": {
		"*.css": "tailwindcss"
	}
}
</file>

<file path="frontend/package.json">
{
	"name": "frontend",
	"private": true,
	"version": "0.0.1",
	"type": "module",
	"scripts": {
		"dev": "vite dev",
		"build": "vite build",
		"preview": "vite preview",
		"prepare": "svelte-kit sync || echo ''",
		"check": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json",
		"check:watch": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json --watch",
		"format": "prettier --write .",
		"lint": "prettier --check ."
	},
	"devDependencies": {
		"@sveltejs/adapter-auto": "^7.0.0",
		"@sveltejs/kit": "^2.49.1",
		"@sveltejs/vite-plugin-svelte": "^6.2.1",
		"@tailwindcss/vite": "^4.1.17",
		"prettier": "^3.7.4",
		"prettier-plugin-svelte": "^3.4.0",
		"prettier-plugin-tailwindcss": "^0.7.2",
		"svelte": "^5.45.6",
		"svelte-check": "^4.3.4",
		"tailwindcss": "^4.1.17",
		"typescript": "^5.9.3",
		"vite": "^7.2.6"
	},
	"dependencies": {
		"lucide-svelte": "^0.562.0",
		"svelte-markdown": "^0.4.1"
	}
}
</file>

<file path="frontend/README.md">
# sv

Everything you need to build a Svelte project, powered by [`sv`](https://github.com/sveltejs/cli).

## Creating a project

If you're seeing this, you've probably already done this step. Congrats!

```sh
# create a new project in the current directory
npx sv create

# create a new project in my-app
npx sv create my-app
```

## Developing

Once you've created a project and installed dependencies with `npm install` (or `pnpm install` or `yarn`), start a development server:

```sh
npm run dev

# or start the server and open the app in a new browser tab
npm run dev -- --open
```

## Building

To create a production version of your app:

```sh
npm run build
```

You can preview the production build with `npm run preview`.

> To deploy your app, you may need to install an [adapter](https://svelte.dev/docs/kit/adapters) for your target environment.
</file>

<file path="frontend/src/app.d.ts">
// See https://svelte.dev/docs/kit/types#app.d.ts
// for information about these interfaces
declare global {
	namespace App {
		// interface Error {}
		// interface Locals {}
		// interface PageData {}
		// interface PageState {}
		// interface Platform {}
	}
}

export {};

declare module 'svelte-markdown';
</file>

<file path="frontend/src/app.html">
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
</file>

<file path="frontend/src/lib/assets/favicon.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="107" height="128" viewBox="0 0 107 128"><title>svelte-logo</title><path d="M94.157 22.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282 29.608A29.92 29.92 0 0 0 8.764 49.65a31.5 31.5 0 0 0 3.108 20.231 30 30 0 0 0-4.477 11.183 31.9 31.9 0 0 0 5.448 24.116c10.402 14.887 30.942 19.297 45.791 9.835l26.083-16.624A29.92 29.92 0 0 0 98.235 78.35a31.53 31.53 0 0 0-3.105-20.232 30 30 0 0 0 4.474-11.182 31.88 31.88 0 0 0-5.447-24.116" style="fill:#ff3e00"/><path d="M45.817 106.582a20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.503 18 18 0 0 1 .624-2.435l.49-1.498 1.337.981a33.6 33.6 0 0 0 10.203 5.098l.97.294-.09.968a5.85 5.85 0 0 0 1.052 3.878 6.24 6.24 0 0 0 6.695 2.485 5.8 5.8 0 0 0 1.603-.704L69.27 76.28a5.43 5.43 0 0 0 2.45-3.631 5.8 5.8 0 0 0-.987-4.371 6.24 6.24 0 0 0-6.698-2.487 5.7 5.7 0 0 0-1.6.704l-9.953 6.345a19 19 0 0 1-5.296 2.326 20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.502 17.99 17.99 0 0 1 8.13-12.052l26.081-16.623a19 19 0 0 1 5.3-2.329 20.72 20.72 0 0 1 22.237 8.243 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-.624 2.435l-.49 1.498-1.337-.98a33.6 33.6 0 0 0-10.203-5.1l-.97-.294.09-.968a5.86 5.86 0 0 0-1.052-3.878 6.24 6.24 0 0 0-6.696-2.485 5.8 5.8 0 0 0-1.602.704L37.73 51.72a5.42 5.42 0 0 0-2.449 3.63 5.79 5.79 0 0 0 .986 4.372 6.24 6.24 0 0 0 6.698 2.486 5.8 5.8 0 0 0 1.602-.704l9.952-6.342a19 19 0 0 1 5.295-2.328 20.72 20.72 0 0 1 22.237 8.242 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-8.13 12.053l-26.081 16.622a19 19 0 0 1-5.3 2.328" style="fill:#fff"/></svg>
</file>

<file path="frontend/src/lib/index.ts">
// place files you want to import through the `$lib` alias in this folder.
</file>

<file path="frontend/src/routes/+layout.svelte">
<script lang="ts">
	import './layout.css';
	import favicon from '$lib/assets/favicon.svg';

	let { children } = $props();
</script>

<svelte:head><link rel="icon" href={favicon} /></svelte:head>
{@render children()}
</file>

<file path="frontend/src/routes/layout.css">
@import 'tailwindcss';
</file>

<file path="frontend/static/robots.txt">
# allow crawling everything by default
User-agent: *
Disallow:
</file>

<file path="frontend/svelte.config.js">
import adapter from '@sveltejs/adapter-auto';
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

/** @type {import('@sveltejs/kit').Config} */
const config = {
	// Consult https://svelte.dev/docs/kit/integrations
	// for more information about preprocessors
	preprocess: vitePreprocess(),

	kit: {
		// adapter-auto only supports some environments, see https://svelte.dev/docs/kit/adapter-auto for a list.
		// If your environment is not supported, or you settled on a specific environment, switch out the adapter.
		// See https://svelte.dev/docs/kit/adapters for more information about adapters.
		adapter: adapter()
	}
};

export default config;
</file>

<file path="frontend/tsconfig.json">
{
	"extends": "./.svelte-kit/tsconfig.json",
	"compilerOptions": {
		"rewriteRelativeImportExtensions": true,
		"allowJs": true,
		"checkJs": true,
		"esModuleInterop": true,
		"forceConsistentCasingInFileNames": true,
		"resolveJsonModule": true,
		"skipLibCheck": true,
		"sourceMap": true,
		"strict": true,
		"moduleResolution": "bundler"
	}
	// Path aliases are handled by https://svelte.dev/docs/kit/configuration#alias
	// except $lib which is handled by https://svelte.dev/docs/kit/configuration#files
	//
	// To make changes to top-level options such as include and exclude, we recommend extending
	// the generated config; see https://svelte.dev/docs/kit/configuration#typescript
}
</file>

<file path="frontend/vite.config.ts">
import tailwindcss from '@tailwindcss/vite';
import { sveltekit } from '@sveltejs/kit/vite';
import { defineConfig } from 'vite';

export default defineConfig({ plugins: [tailwindcss(), sveltekit()] });
</file>

<file path="frontend/src/routes/+page.svelte">
<script lang="ts">
	import { Send, Menu, MessageSquare, User, Bot, Trash2, Plus } from 'lucide-svelte';
	import { tick, onMount } from 'svelte'; // 引入 onMount
	import SvelteMarkdown from 'svelte-markdown';

	// --- 1. 状态定义 ---
	let isSidebarOpen = $state(false);
	let inputText = $state(''); 
	let chatHistory = $state([
		{ role: 'assistant', content: '你好！我是 LobeChat 助手。我已经准备好为你服务了。' }
	]);

	let scrollContainer: HTMLElement | undefined = $state();

	// --- 2. 页面加载时：从后端数据库读取历史记录 ---
	onMount(async () => {
		try {
			const response = await fetch('http://localhost:8080/api/history');
			if (response.ok) {
				const history = await response.json();
				// 如果数据库里有记录，就替换掉默认的欢迎语
				if (history && history.length > 0) {
					chatHistory = history;
					await scrollToBottom();
				}
			}
		} catch (error) {
			console.error('加载历史记录失败:', error);
		}
	});

	// --- 3. 核心逻辑函数 ---

	async function sendMessage() {
		if (!inputText.trim()) return;

		const userMessage = inputText;
		chatHistory.push({ role: 'user', content: userMessage });
		inputText = ''; 
		await scrollToBottom();

		try {
			chatHistory.push({ role: 'assistant', content: '' });
			const aiMsgIndex = chatHistory.length - 1;

			const response = await fetch('http://localhost:8080/api/chat', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify({ message: userMessage })
			});

			if (!response.ok) throw new Error('后端响应错误');

			const reader = response.body?.getReader();
			const decoder = new TextDecoder();

			if (reader) {
				while (true) {
					const { done, value } = await reader.read();
					if (done) break;

					const chunk = decoder.decode(value);
					const lines = chunk.split('\n');
					for (const line of lines) {
						if (line.startsWith('data: ')) {
							const content = line.replace('data: ', '');
							chatHistory[aiMsgIndex].content += content;
							await scrollToBottom();
						}
					}
				}
			}
		} catch (error) {
			console.error('连接后端失败:', error);
			chatHistory.push({ role: 'assistant', content: '抱歉，我跟后端服务器失去联系了。' });
			await scrollToBottom();
		}
	}

	function handleKeyDown(event: KeyboardEvent) {
		if (event.key === 'Enter' && !event.shiftKey) {
			event.preventDefault();
			sendMessage();
		}
	}

	async function scrollToBottom() {
		await tick();
		if (scrollContainer) {
			scrollContainer.scrollTo({
				top: scrollContainer.scrollHeight,
				behavior: 'smooth'
			});
		}
	}

	function toggleSidebar() {
		isSidebarOpen = !isSidebarOpen;
	}

	function clearChat() {
		if (confirm('确定要清空所有聊天记录吗？这也会删除数据库里的记录。')) {
			// 这里可以扩展一个删除数据库的接口，目前先简单清空界面
			chatHistory = [{ role: 'assistant', content: '对话已清空。' }];
		}
	}
</script>

<div class="flex h-screen w-full bg-[#f8f9fa] text-[#333] overflow-hidden font-sans">
	
	<!-- 侧边栏 -->
	<aside class="fixed inset-y-0 left-0 z-50 w-72 bg-white border-r border-gray-200 transform transition-transform duration-300 ease-in-out {isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} md:relative md:translate-x-0 md:flex md:flex-col">
		<div class="p-4 border-b border-gray-100 flex justify-between items-center">
			<div class="flex items-center gap-2 font-bold text-lg text-blue-600">
				<div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white text-sm">L</div>
				LobeChat Mini
			</div>
			<button class="md:hidden p-2" onclick={toggleSidebar} aria-label="关闭侧边栏"><Menu size={20} /></button>
		</div>
		<div class="p-3">
			<button onclick={() => chatHistory = [{ role: 'assistant', content: '新对话已开启！' }]} class="w-full flex items-center justify-center gap-2 bg-blue-600 text-white py-2 rounded-xl hover:bg-blue-700 transition shadow-md shadow-blue-100">
				<Plus size={18} /> 新建对话
			</button>
		</div>
		<nav class="flex-1 overflow-y-auto px-2 space-y-1">
			<div class="flex items-center gap-3 p-3 bg-blue-50 text-blue-700 rounded-xl cursor-pointer">
				<MessageSquare size={18} />
				<span class="text-sm font-medium truncate">当前的智能对话</span>
			</div>
		</nav>
		<div class="p-4 border-t border-gray-100 text-xs text-gray-400 text-center">
			已连接 SQLite 数据库
		</div>
	</aside>

	{#if isSidebarOpen}
		<button class="fixed inset-0 bg-black/20 z-40 md:hidden w-full h-full border-none outline-none" onclick={toggleSidebar} aria-label="关闭遮罩"></button>
	{/if}

	<main class="flex flex-1 flex-col min-w-0 bg-white relative">
		<header class="h-14 flex items-center justify-between px-4 border-b border-gray-100 bg-white/80 backdrop-blur-md sticky top-0 z-30">
			<div class="flex items-center gap-3">
				<button class="md:hidden p-2 -ml-2 text-gray-500" onclick={toggleSidebar} aria-label="打开侧边栏"><Menu size={20} /></button>
				<div class="flex flex-col">
					<span class="text-sm font-bold text-gray-700">DeepSeek-V3</span>
					<span class="text-[10px] text-green-500 flex items-center gap-1">
						<span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span> 数据库已就绪
					</span>
				</div>
			</div>
			<button class="p-2 text-gray-400 hover:text-red-500 transition" onclick={clearChat} aria-label="清空对话"><Trash2 size={18} /></button>
		</header>

		<section bind:this={scrollContainer} class="flex-1 overflow-y-auto p-4 md:p-6 space-y-6 scroll-smooth">
			<div class="max-w-3xl mx-auto space-y-6">
				{#each chatHistory as msg}
					<div class="flex {msg.role === 'user' ? 'justify-end' : 'justify-start'}">
						<div class="flex max-w-[90%] md:max-w-[85%] gap-3 {msg.role === 'user' ? 'flex-row-reverse' : 'flex-row'}">
							<div class="w-8 h-8 rounded-xl flex-shrink-0 flex items-center justify-center {msg.role === 'user' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600'}">
								{#if msg.role === 'user'} <User size={16} /> {:else} <Bot size={16} /> {/if}
							</div>
							<div class="px-4 py-2.5 rounded-2xl text-sm leading-relaxed shadow-sm {msg.role === 'user' ? 'bg-blue-600 text-white rounded-tr-none' : 'bg-[#f2f3f5] text-gray-800 rounded-tl-none'}">
								<div class="markdown-body">
									<SvelteMarkdown source={msg.content} />
								</div>
							</div>
						</div>
					</div>
				{/each}
			</div>
		</section>

		<footer class="p-4 bg-white border-t border-gray-100">
			<div class="max-w-3xl mx-auto relative">
				<div class="flex items-end gap-2 bg-[#f4f4f4] rounded-2xl p-2 border border-transparent focus-within:border-blue-400 focus-within:bg-white transition-all shadow-inner">
					<textarea bind:value={inputText} onkeydown={handleKeyDown} placeholder="输入消息，Enter 发送..." class="flex-1 max-h-32 min-h-[40px] p-2 bg-transparent border-none focus:outline-none text-sm resize-none" rows="1"></textarea>
					<button onclick={sendMessage} aria-label="发送消息" class="p-2 bg-blue-600 text-white rounded-xl disabled:opacity-30 disabled:bg-gray-400 transition-all hover:scale-105 active:scale-95" disabled={!inputText.trim()}><Send size={18} /></button>
				</div>
			</div>
		</footer>
	</main>
</div>

<style>
	.markdown-body :global(p) { margin-bottom: 0.5rem; }
	.markdown-body :global(p:last-child) { margin-bottom: 0; }
	.markdown-body :global(code) { background: rgba(0,0,0,0.05); padding: 0.2rem 0.4rem; border-radius: 4px; font-family: monospace; }
	.markdown-body :global(pre) { background: #2d2d2d; color: #ccc; padding: 1rem; border-radius: 8px; overflow-x: auto; margin: 0.5rem 0; }
	
	:global(::-webkit-scrollbar) { width: 4px; }
	:global(::-webkit-scrollbar-thumb) { background: #e5e7eb; border-radius: 10px; }
</style>
</file>

</files>
